<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manipulation of general linear matrix pencils · MatrixPencils.jl</title><meta name="title" content="Manipulation of general linear matrix pencils · MatrixPencils.jl"/><meta property="og:title" content="Manipulation of general linear matrix pencils · MatrixPencils.jl"/><meta property="twitter:title" content="Manipulation of general linear matrix pencils · MatrixPencils.jl"/><meta name="description" content="Documentation for MatrixPencils.jl."/><meta property="og:description" content="Documentation for MatrixPencils.jl."/><meta property="twitter:description" content="Documentation for MatrixPencils.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">MatrixPencils.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><span class="tocitem">Library</span><ul><li class="is-active"><a class="tocitem" href="klftools.html">Manipulation of general linear matrix pencils</a></li><li><a class="tocitem" href="sklftools.html">Manipulation of structured linear matrix pencils</a></li><li><a class="tocitem" href="klfapps.html">Some applications of matrix pencil computations</a></li><li><a class="tocitem" href="sklfapps.html">Some applications of structured matrix pencil computations</a></li><li><a class="tocitem" href="pregular.html">Computations involving regular matrix pencils</a></li><li><a class="tocitem" href="lstools.html">Manipulation of linearizations of polynomial or rational matrices</a></li><li><a class="tocitem" href="pmtools.html">Manipulation of polynomial matrices</a></li><li><a class="tocitem" href="pmapps.html">Some applications to polynomial matrices</a></li><li><a class="tocitem" href="rmtools.html">Manipulation of rational matrices</a></li><li><a class="tocitem" href="rmapps.html">Some applications to rational matrices</a></li></ul></li><li><span class="tocitem">Internal</span><ul><li><a class="tocitem" href="klftools_int.html">Basic reductions of general and structured linear matrix pencils</a></li></ul></li><li><a class="tocitem" href="makeindex.html">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href="klftools.html">Manipulation of general linear matrix pencils</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="klftools.html">Manipulation of general linear matrix pencils</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/andreasvarga/MatrixPencils.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/master/docs/src/klftools.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Manipulation-of-general-linear-matrix-pencils"><a class="docs-heading-anchor" href="#Manipulation-of-general-linear-matrix-pencils">Manipulation of general linear matrix pencils</a><a id="Manipulation-of-general-linear-matrix-pencils-1"></a><a class="docs-heading-anchor-permalink" href="#Manipulation-of-general-linear-matrix-pencils" title="Permalink"></a></h1><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.pbalance!"><code>pbalance!</code></a></strong></td><td style="text-align: left">Balancing arbitrary matrix pencils.</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.pbalqual"><code>pbalqual</code></a></strong></td><td style="text-align: left">Balancing quality of a matrix pencils.</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf"><code>klf</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the full Kronecker structure</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_right"><code>klf_right</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the right and finite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_rightinf"><code>klf_rightinf</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the right and infinite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_left"><code>klf_left</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the left and finite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_leftinf"><code>klf_leftinf</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the left and infinite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_rlsplit"><code>klf_rlsplit</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the separation of right and left Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.preduceBF"><code>preduceBF</code></a></strong></td><td style="text-align: left">Reduction to the basic condensed form  <code>[B A-λE; D C]</code> with <code>E</code> upper triangular and nonsingular.</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_right!"><code>klf_right!</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the right and finite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_right_refine!"><code>klf_right_refine!</code></a></strong></td><td style="text-align: left">Update the Kronecker-like form by splitting the right and infinite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_right_refineut!"><code>klf_right_refineut!</code></a></strong></td><td style="text-align: left">Refine the Kronecker-like form by enforcing upper triangular shapes of blocks in the leading full row rank subpencil</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_right_refineinf!"><code>klf_right_refineinf!</code></a></strong></td><td style="text-align: left">Refine the Kronecker-like form by enforcing upper triangular shapes of blocks in its infinite regular part</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_left!"><code>klf_left!</code></a></strong></td><td style="text-align: left">Computation of the Kronecker-like form exhibiting the left and finite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_left_refine!"><code>klf_left_refine!</code></a></strong></td><td style="text-align: left">Update the Kronecker-like form by splitting the left and infinite Kronecker structures</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_left_refineut!"><code>klf_left_refineut!</code></a></strong></td><td style="text-align: left">Refine the Kronecker-like form by enforcing upper triangular shapes of blocks in the leading full row rank subpencil</td></tr><tr><td style="text-align: left"><strong><a href="klftools.html#MatrixPencils.klf_left_refineinf!"><code>klf_left_refineinf!</code></a></strong></td><td style="text-align: left">Refine the Kronecker-like form by enforcing upper triangular shapes of blocks in its infinite regular part</td></tr></table><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.pbalance!" href="#MatrixPencils.pbalance!"><code>MatrixPencils.pbalance!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pbalance!(M, N; r, c, regpar, shift, maxiter, tol, pow2) -&gt; (Dl, Dr)</code></pre><p>Balance the <code>m×n</code> matrix pencil <code>M - λN</code> by reducing the 1-norm of the matrix <code>T := abs(M)+abs(N)</code> by row and column balancing.  This involves similarity transformations with diagonal matrices <code>Dl</code> and <code>Dr</code> applied to <code>T</code> to make the rows and columns of <code>Dl*T*Dr</code> as close in norm as possible. The modified <a href="https://en.wikipedia.org/wiki/Sinkhorn%27s_theorem">Sinkhorn–Knopp algorithm</a> described in [1]  is employed to reduce <code>T</code> to an approximately doubly stochastic matrix.  The targeted row and column sums can be specified using the keyword arguments <code>r = rs</code> and <code>c = cs</code>,  where <code>rs</code> and <code>cs</code> are <code>m-</code> and <code>n-</code>dimensional positive vectors,  representing the desired row and column sums, respectively (Default: <code>rs = ones(m)</code> and <code>cs = ones(n)</code>).</p><p>The resulting <code>Dl</code> and <code>Dr</code> are diagonal scaling matrices.   If the keyword argument <code>pow2 = true</code> is specified, then the components of the resulting  optimal <code>Dl</code> and <code>Dr</code> are replaced by their nearest integer powers of 2.  If <code>pow2 = false</code>, the optimal values <code>Dl</code> and <code>Dr</code> are returned. The resulting <code>Dl*M*Dr</code> and <code>Dl*N*Dr</code> overwrite <code>M</code> and <code>N</code>, respectively</p><p>A regularization-based scaling is performed if a nonzero regularization parameter <code>α</code> is specified via the keyword argument <code>regpar = α</code>.   If <code>diagreg = true</code>, then the balancing algorithm is performed on the extended symmetric matrix <code>[ α^2*I  T; T&#39; α^2*I ]</code>, while if <code>diagreg = false</code> (default),    the balancing algorithm is performed on the matrix <code>[ (α/m)^2*em*em&#39;  T; T&#39; (α/n)^2*en*en&#39; ]</code>,  where <code>em</code> and <code>en</code> are <code>m-</code> and <code>n-</code>dimensional vectors with elements equal to one.   If <code>α = 0</code> and <code>shift = γ &gt; 0</code> is specified, then the algorithm is performed on the rank-one perturbation <code>T+γ*em*en</code>. </p><p>The keyword argument <code>tol = τ</code>, with <code>τ ≤ 1</code>,  specifies the tolerance used in the stopping criterion.  The iterative process is stopped as soon as the incremental scalings are <code>tol</code>-close to the identity. </p><p>The keyword argument <code>maxiter = k</code> specifies the maximum number of iterations <code>k</code>  allowed in the balancing algorithm. </p><p><em>Method:</em> This function employs the regularization approaches proposed in [1], modified  to handle matrices with zero rows or zero columns. The alternative shift based regularization  has been proposed in [2].  </p><p>[1] F.M.Dopico, M.C.Quintana and P. van Dooren,      &quot;Diagonal scalings for the eigenstructure of arbitrary pencils&quot;, SIMAX, 43:1213-1237, 2022. </p><p>[2] P.A.Knight, The Sinkhorn–Knopp algorithm: Convergence and applications, SIAM J. Matrix     Anal. Appl., 30 (2008), pp. 261–275.   </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/lputil.jl#L1-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.pbalqual" href="#MatrixPencils.pbalqual"><code>MatrixPencils.pbalqual</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qs = pbalqual(M, N)</code></pre><p>Compute the 1-norm based scaling quality of a matrix pencil <code>M-λN</code>.</p><p>The resulting <code>qs</code> is computed as </p><pre><code class="nohighlight hljs">    qs = qS(abs(M)+abs(N)) ,</code></pre><p>where <code>qS(⋅)</code> is the scaling quality measure defined in Definition 5.5 of [1] for  nonnegative matrices. This definition has been extended to also cover matrices with zero rows or columns. If <code>N = I</code>, <code>qs = qs(M)</code> is computed. </p><p>A large value of <code>qs</code> indicates a possibly poorly scaled matrix pencil.   </p><p>[1] F.M.Dopico, M.C.Quintana and P. van Dooren,      &quot;Diagonal scalings for the eigenstructure of arbitrary pencils&quot;, SIMAX, 43:1213-1237, 2022. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/lputil.jl#L79-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf" href="#MatrixPencils.klf"><code>MatrixPencils.klf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf(M, N; fast = true, finite_infinite = false, ut = false, atol1 = 0, atol2 = 0, rtol, withQ = true, withZ = true) -&gt; (F, G, Q, Z, νr, μr, νi, nf, νl, μl)</code></pre><p>Reduce the matrix pencil <code>M - λN</code> to an equivalent form <code>F - λG = Q&#39;(M - λN)Z</code> using  orthogonal or unitary transformation matrices <code>Q</code> and <code>Z</code> such that the transformed matrices <code>F</code> and <code>G</code> are in the following Kronecker-like form exhibiting the complete Kronecker structure:</p><pre><code class="nohighlight hljs">               |  Mr-λNr  |     *      |    *    |
               |----------|------------|---------|
     F - λG =  |    O     | Mreg-λNreg |    *    |
               |----------|------------|---------|
               |    O     |     0      |  Ml-λNl |</code></pre><p>The full row rank pencil <code>Mr-λNr</code> is in a staircase form, contains the right Kronecker indices  of the pencil <code>M-λN</code>and has the form</p><pre><code class="nohighlight hljs">     Mr-λNr  = | Br | Ar-λEr |,</code></pre><p>where <code>Er</code> is upper triangular and nonsingular.  The <code>nr</code>-dimensional vectors <code>νr</code> and <code>μr</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mr-λNr</code> such that the <code>i</code>-th block has dimensions <code>νr[i] x μr[i]</code> and  has full row rank. The difference <code>μr[i]-νr[i]</code> for <code>i = 1, 2, ..., nr</code> is the number of elementary Kronecker  blocks of size <code>(i-1) x i</code>.  If <code>ut = true</code>, the full row rank diagonal blocks of <code>Mr</code> are reduced to the form <code>[0 X]</code>  with <code>X</code> upper triangular and nonsingular and the full column rank supradiagonal blocks of <code>Nr</code> are reduced to the form <code>[Y; 0]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The pencil <code>Mreg-λNreg</code> is regular, contains the infinite and finite elementary divisors of <code>M-λN</code> and has the form</p><pre><code class="nohighlight hljs">                   | Mi-λNi |    *    |
     Mreg-λNreg  = |--------|---------|, if `finite_infinite = false`, or the form
                   |   0    |  Mf-λNf |


                   | Mf-λNf |    *    |
     Mreg-λNreg  = |--------|---------|, if `finite_infinite = true`, 
                   |   0    |  Mi-λNi |</code></pre><p>where: (1) <code>Mi-λNi</code>, in staircase form, contains the infinite elementary divisors of <code>M-λN</code>,  <code>Mi</code> upper triangular if <code>ut = true</code> and nonsingular, and <code>Ni</code> is upper triangular and nilpotent;  (2) <code>Mf-λNf</code> contains the infinite elementary divisors of <code>M-λN</code> and  <code>Nf</code> is upper triangular and nonsingular. The <code>ni</code>-dimensional vector <code>νi</code> contains the dimensions of the square blocks of the staircase form  <code>Mi-λNi</code>  such that the <code>i</code>-th block has dimensions <code>νi[i] x νi[i]</code>.  If <code>finite_infinite = true</code>, the difference <code>νi[i]-νi[i+1]</code> for <code>i = 1, 2, ..., ni</code>  is the number of infinite elementary divisors of degree <code>i</code> (with <code>νi[ni] = 0</code>). If <code>finite_infinite = false</code>, the difference <code>νi[ni-i+1]-νi[ni-i]</code> for <code>i = 1, 2, ..., ni</code>  is the number of infinite elementary divisors of degree <code>i</code> (with <code>νi[0] = 0</code>).</p><p>The full column rank pencil <code>Ml-λNl</code>, in a staircase form, contains the left Kronecker indices of <code>M-λN</code> and has the form</p><pre><code class="nohighlight hljs">               | Al-λEl |
     Ml-λNl  = |--------|,
               |   Cl   |</code></pre><p>where <code>El</code> is upper triangular and nonsingular.  The <code>nl</code>-dimensional vectors <code>νl</code> and <code>μl</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Ml-λNl</code> such that the <code>j</code>-th block has dimensions <code>νl[j] x μl[j]</code> and has full column rank.  The difference <code>νl[nl-j+1]-μl[nl-j+1]</code> for <code>j = 1, 2, ..., nl</code> is the number of elementary Kronecker blocks of size  <code>j x (j-1)</code>. If <code>ut = true</code>, the full column rank diagonal blocks of <code>Ml</code> are reduced to the form <code>[X; 0]</code>  with <code>X</code> upper triangular and nonsingular and the full row rank supradiagonal blocks of <code>Nl</code> are reduced to the form <code>[0 Y]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The keyword arguments <code>atol1</code>, <code>atol2</code>, and <code>rtol</code>, specify, respectively, the absolute tolerance for the  nonzero elements of <code>M</code>, the absolute tolerance for the nonzero elements of <code>N</code>,  and the relative tolerance  for the nonzero elements of <code>M</code> and <code>N</code>.  The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> if <code>withQ = true</code>.  Otherwise, <code>Q</code> is set to <code>nothing</code>.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> if <code>withZ = true</code>.  Otherwise, <code>Z</code> is set to <code>nothing</code>.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L214-L288">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_right" href="#MatrixPencils.klf_right"><code>MatrixPencils.klf_right</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_right(M, N; fast = true, ut = false, atol1 = 0, atol2 = 0, rtol, withQ = true, withZ = true) -&gt; (F, G, Q, Z, νr, μr, nf, ν, μ)</code></pre><p>Reduce the matrix pencil <code>M - λN</code> to an equivalent form <code>F - λG = Q&#39;(M - λN)Z</code> using  orthogonal or unitary transformation matrices <code>Q</code> and <code>Z</code> such that the transformed matrices <code>F</code> and <code>G</code> are in the following Kronecker-like form exhibiting the right and finite Kronecker structures:</p><pre><code class="nohighlight hljs">               |  Mr-λNr    |     *      |    *     |
               |------------|------------|----------|
     F - λG =  |    O       |   Mf-λNf   |    *     |
               |------------|------------|----------|
               |    O       |     0      | Mil-λNil |</code></pre><p>The full row rank pencil <code>Mr-λNr</code>, in a staircase form, contains the right Kronecker indices of <code>M-λN</code> and has the form</p><pre><code class="nohighlight hljs">     Mr-λNr  = | Br | Ar-λEr |,</code></pre><p>where <code>Er</code> is upper triangular and nonsingular.  The <code>nr</code>-dimensional vectors <code>νr</code> and <code>μr</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mr-λNr</code> such that <code>i</code>-th block has dimensions <code>νr[i] x μr[i]</code> and  has full row rank. The difference <code>μr[i]-νr[i]</code> for <code>i = 1, 2, ..., nr</code> is the number of elementary Kronecker blocks of size <code>(i-1) x i</code>. If <code>ut = true</code>, the full row rank diagonal blocks of <code>Mr</code> are reduced to the form <code>[0 X]</code>  with <code>X</code> upper triangular and nonsingular and the full column rank supradiagonal blocks of <code>Nr</code> are reduced to the form <code>[Y; 0]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The <code>nf x nf</code> pencil <code>Mf-λNf</code> is regular and contains the finite elementary divisors of <code>M-λN</code>.  <code>Nf</code> is upper triangular and nonsingular.</p><p>The full column rank pencil <code>Mil-λNil</code> is in a staircase form, and contains the  left Kronecker indices  and infinite elementary divisors of the pencil <code>M-λN</code>.  The <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mil-λNil</code> such that the <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code> and has full column rank.  The difference <code>ν[nb-j+1]-μ[nb-j+1]</code> for <code>j = 1, 2, ..., nb</code> is the number of elementary Kronecker blocks of size  <code>j x (j-1)</code>. The difference <code>μ[nb-j+1]-ν[nb-j]</code> for <code>j = 1, 2, ..., nb</code> is the number of infinite elementary  divisors of degree <code>j</code> (with <code>ν[0] = 0</code>). If <code>ut = true</code>, the full column rank diagonal blocks of <code>Mil</code> are reduced to the form <code>[X; 0]</code>  with <code>X</code> upper triangular and nonsingular and the full row rank supradiagonal blocks of <code>Nil</code> are reduced to the form <code>[0 Y]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The keyword arguments <code>atol1</code>, <code>atol2</code>, and <code>rtol</code>, specify, respectively, the absolute tolerance for the  nonzero elements of <code>M</code>, the absolute tolerance for the nonzero elements of <code>N</code>,  and the relative tolerance  for the nonzero elements of <code>M</code> and <code>N</code>.  The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> if <code>withQ = true</code>.  Otherwise, <code>Q</code> is set to <code>nothing</code>.    The performed right orthogonal or unitary or unitary transformations are accumulated in the matrix <code>Z</code> if <code>withZ = true</code>.  Otherwise, <code>Z</code> is set to <code>nothing</code>.   </p><p><code>Note:</code> If the pencil <code>M - λN</code> has full row rank, then the regular pencil <code>Mil-λNil</code> is in a staircase form with square upper triangular diagonal blocks (i.e.,<code>μ[j] = ν[j]</code>), and the difference <code>ν[nb-j+1]-ν[nb-j]</code> for  <code>j = 1, 2, ..., nb</code> is the number of infinite elementary divisors of degree <code>j</code> (with <code>ν[0] = 0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L356-L410">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_rightinf" href="#MatrixPencils.klf_rightinf"><code>MatrixPencils.klf_rightinf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_rightinf(M, N; fast = true, ut = false, atol1 = 0, atol2 = 0, rtol, withQ = true, withZ = true) 
            -&gt; (F, G, Q, Z, νr, μr, νi, n, p)</code></pre><p>Reduce the matrix pencil <code>M - λN</code> to an equivalent form <code>F - λG = Q&#39;(M - λN)Z</code> using  orthogonal or unitary transformation matrices <code>Q</code> and <code>Z</code> such that the transformed matrices <code>F</code> and <code>G</code> are in the following Kronecker-like form exhibiting the infinite and left Kronecker structures:</p><pre><code class="nohighlight hljs">               |  Mr-λNr  |     *      |    *     |
               |----------|------------|----------|
     F - λG =  |    O     |   Mi-λNi   |    *     |
               |----------|------------|----------|
               |    O     |     0      | Mfl-λNfl |</code></pre><p>The full row rank pencil <code>Mr-λNr</code> is in a staircase form, contains the right Kronecker indices  of the pencil <code>M-λN</code>and has the form</p><pre><code class="nohighlight hljs">     Mr-λNr  = | Br | Ar-λEr |,</code></pre><p>where <code>Er</code> is upper triangular and nonsingular.  The <code>nr</code>-dimensional vectors <code>νr</code> and <code>μr</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mr-λNr</code> such that the <code>i</code>-th block has dimensions <code>νr[i] x μr[i]</code> and  has full row rank. The difference <code>μr[i]-νr[i]</code> for <code>i = 1, 2, ..., nr</code> is the number of elementary Kronecker  blocks of size <code>(i-1) x i</code>.  If <code>ut = true</code>, the full row rank diagonal blocks of <code>Mr</code> are reduced to the form <code>[0 X]</code>  with <code>X</code> upper triangular and nonsingular and the full column rank supradiagonal blocks of <code>Nr</code> are reduced to the form <code>[Y; 0]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The regular pencil <code>Mi-λNi</code> is in a staircase form, contains the infinite elementary divisors of <code>M-λN</code>  with <code>Mi</code> upper triangular if <code>ut = true</code> and nonsingular, and <code>Ni</code> is upper triangular and nilpotent.  The <code>ni</code>-dimensional vector <code>νi</code> contains the dimensions of the  square diagonal blocks of the staircase form  <code>Mi-λNi</code> such that the <code>i</code>-th block has dimensions <code>νi[i] x νi[i]</code>.  The difference <code>νi[ni-i+1]-νi[ni-i]</code> for <code>i = 1, 2, ..., ni</code> is the number of infinite elementary divisors of degree <code>i</code> (with <code>νi[0] = 0</code>).</p><p>The full column rank pencil <code>Mfl-λNfl</code> contains the left Kronecker   and finite Kronecker structures of the pencil <code>M-λN</code> and is in the form </p><pre><code class="nohighlight hljs">                 | A-λE | 
      Mfl-λNfl = |------| ,        
                 |  C   |</code></pre><p>where <code>E</code> is an nxn non-singular upper triangular matrix, and <code>A</code> and <code>C</code> are <code>nxn</code>- and <code>pxn</code>-dimensional matrices, respectively.                      </p><p>The keyword arguments <code>atol1</code>, <code>atol2</code>, and <code>rtol</code>, specify, respectively, the absolute tolerance for the  nonzero elements of <code>M</code>, the absolute tolerance for the nonzero elements of <code>N</code>,  and the relative tolerance  for the nonzero elements of <code>M</code> and <code>N</code>.  The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> if <code>withQ = true</code>.  Otherwise, <code>Q</code> is set to <code>nothing</code>.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> if <code>withZ = true</code>.  Otherwise, <code>Z</code> is set to <code>nothing</code>.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L509-L564">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_rlsplit" href="#MatrixPencils.klf_rlsplit"><code>MatrixPencils.klf_rlsplit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_rlsplit(M, N; fast = true, finite_infinite = false, atol1 = 0, atol2 = 0, rtol, withQ = true, withZ = true) -&gt; (F, G, Q, Z, ν, μ, n, m, p)</code></pre><p>Reduce the matrix pencil <code>M - λN</code> to an equivalent form <code>F - λG = Q&#39;*(M - λN)*Z</code> using  orthogonal or unitary transformation matrices <code>Q</code> and <code>Z</code> such that the transformed matrices <code>F</code> and <code>G</code> are in one of the following Kronecker-like forms:</p><p>(1) if <code>finite_infinite = false</code>, then</p><pre><code class="nohighlight hljs">               | Mri-λNri |     *      |
      F - λG = |----------|------------|, 
               |    O     | Mfl-λNfl   |</code></pre><p>where the subpencil <code>Mri-λNri</code> contains the right Kronecker structure and infinite elementary  divisors and the subpencil <code>Mfl-λNfl</code> contains the finite and left Kronecker structure of the pencil <code>M-λN</code>.</p><p>The full row rank subpencil <code>Mri-λNri</code> is in a staircase form.  The <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mri-λNri</code> such that <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code> and  has full row rank.  The difference <code>μ[i]-ν[i]</code> for <code>i = 1, 2, ..., nb</code> is the number of elementary Kronecker blocks of size <code>(i-1) x i</code>. The difference <code>ν[i]-μ[i+1]</code> for <code>i = 1, 2, ..., nb</code> is the number of infinite elementary divisors of degree <code>i</code>  (with <code>μ[nb+1] = 0</code>).</p><p>The full column rank subpencil <code>Mfl-λNfl</code> is in the form </p><pre><code class="nohighlight hljs">                 | A-λE | 
      Mfl-λNfl = |------| ,        
                 |  C   |</code></pre><p>where <code>E</code> is an nxn non-singular upper triangular matrix, and <code>A</code> and <code>C</code> are <code>nxn</code>- and <code>pxn</code>-dimensional matrices, respectively, and <code>m = 0</code>. </p><p>(2) if <code>finite_infinite = true</code>, then</p><pre><code class="nohighlight hljs">               | Mrf-λNrf |     *      |
      F - λG = |----------|------------|, 
               |    O     | Mil-λNil   |</code></pre><p>where the subpencil <code>Mrf-λNrf</code> contains the right Kronecker and finite Kronecker structures and  the subpencil <code>Mil-λNil</code> contains the left Kronecker structures and infinite elementary  divisors of the pencil <code>M-λN</code>. </p><p>The full row rank subpencil <code>Mrf-λNrf</code> is in the form </p><pre><code class="nohighlight hljs">      Mrf-λNrf = | B  | A-λE | ,</code></pre><p>where <code>E</code> is an <code>nxn</code> non-singular upper triangular matrix, and <code>A</code> and <code>B</code> are <code>nxn</code>- and <code>nxm</code>-dimensional matrices, respectively, and <code>p = 0</code>.  </p><p>The full column rank sub pencil <code>Mil-λNil</code> is in a staircase form.  The <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mil-λNil</code> such that the <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code> and has full column rank.  The difference <code>ν[nb-j+1]-μ[nb-j+1]</code> for <code>j = 1, 2, ..., nb</code> is the number of elementary Kronecker blocks of size  <code>j x (j-1)</code>. The difference <code>μ[nb-j+1]-ν[nb-j]</code> for <code>j = 1, 2, ..., nb</code> is the number of infinite elementary  divisors of degree <code>j</code> (with <code>ν[0] = 0</code>).</p><p>The keyword arguments <code>atol1</code>, <code>atol2</code>, and <code>rtol</code>, specify, respectively, the absolute tolerance for the  nonzero elements of <code>M</code>, the absolute tolerance for the nonzero elements of <code>N</code>,  and the relative tolerance  for the nonzero elements of <code>M</code> and <code>N</code>. </p><p>The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> if <code>withQ = true</code>.  Otherwise, <code>Q</code> is set to <code>nothing</code>.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> if <code>withZ = true</code>.  Otherwise, <code>Z</code> is set to <code>nothing</code>.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L49-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.preduceBF" href="#MatrixPencils.preduceBF"><code>MatrixPencils.preduceBF</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">preduceBF(M, N; fast = true, atol = 0, rtol, withQ = true, withZ = true) -&gt; (F, G, Q, Z, n, m, p)</code></pre><p>Reduce the matrix pencil <code>M - λN</code> to an equivalent form <code>F - λG = Q&#39;*(M - λN)*Z</code> using  orthogonal or unitary transformation matrices <code>Q</code> and <code>Z</code> such that the pencil <code>M - λN</code> is transformed  into the following standard form</p><pre><code class="nohighlight hljs">               | B  | A-λE | 
      F - λG = |----|------| ,        
               | D  |  C   |</code></pre><p>where <code>E</code> is an <code>nxn</code> non-singular matrix, and <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code> are <code>nxn</code>-, <code>nxm</code>-, <code>pxn</code>- and <code>pxm</code>-dimensional matrices, respectively. The order <code>n</code> of <code>E</code> is equal to the numerical rank of <code>N</code> determined using the absolute tolerance <code>atol</code> and  relative tolerance <code>rtol</code>. <code>M</code> and <code>N</code> are overwritten by <code>F</code> and <code>G</code>, respectively. </p><p>If <code>fast = true</code>, <code>E</code> is determined upper triangular using a rank revealing QR-decomposition with column pivoting of <code>N</code>  and <code>n</code> is evaluated as the number of nonzero diagonal elements of the <code>R</code> factor, whose magnitudes are greater than  <code>tol = max(atol,abs(R[1,1])*rtol)</code>.  If <code>fast = false</code>,  <code>E</code> is determined diagonal using a rank revealing SVD-decomposition of <code>N</code> and  <code>n</code> is evaluated as the number of singular values greater than <code>tol = max(atol,smax*rtol)</code>, where <code>smax</code>  is the largest singular value.  The rank decision based on the SVD-decomposition is generally more reliable, but the involved computational effort is higher.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> if <code>withQ = true</code>.  Otherwise, <code>Q</code> is set to <code>nothing</code>.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> if <code>withZ = true</code>.  Otherwise, <code>Z</code> is set to <code>nothing</code>.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_right!" href="#MatrixPencils.klf_right!"><code>MatrixPencils.klf_right!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_right!(M, N; fast = true, roff = 0, coff = 0, rtrail = 0, ctrail = 0, atol = 0, rtol, withQ = true, withZ = true) -&gt; (Q, Z, νr, μr, nf, ν, μ, tol)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">          [   *         *        *  ] roff
 M - λN = [   0      M22-λN22    *  ] m
          [   0         0        *  ] rtrail
            coff        n     ctrail</code></pre><p>to an equivalent form <code>F - λG = Q1&#39;*(M - λN)*Z1</code> using orthogonal or unitary transformation matrices <code>Q1</code> and <code>Z1</code>  such that the subpencil <code>M22 - λN22</code> is transformed into the following Kronecker-like form exhibiting  its right and finite Kronecker structures:</p><pre><code class="nohighlight hljs">               |  Mr-λNr    |     *      |    *     |
               |------------|------------|----------|
 F22 - λG22 =  |    O       |   Mf-λNf   |    *     |
               |------------|------------|----------|
               |    O       |     0      | Mil-λNil |</code></pre><p><code>F</code> and <code>G</code> are returned in <code>M</code> and <code>N</code>, respectively.                </p><p>The full row rank pencil <code>Mr-λNr</code>, in a staircase form, contains the right Kronecker indices of  the subpencil <code>M22 - λN22</code> and has the form</p><pre><code class="nohighlight hljs">     Mr-λNr  = | Br | Ar-λEr |,</code></pre><p>where <code>Er</code> is upper triangular and nonsingular.  The <code>nr</code>-dimensional vectors <code>νr</code> and <code>μr</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mr-λNr</code> such that <code>i</code>-th block has dimensions <code>νr[i] x μr[i]</code> and  has full row rank. The difference <code>μr[i]-νr[i]</code> for <code>i = 1, 2, ..., nr</code> is the number of elementary Kronecker blocks of size <code>(i-1) x i</code>.</p><p>The <code>nf x nf</code> pencil <code>Mf-λNf</code> is regular and contains the finite elementary divisors of the subpencil <code>M22 - λN22</code>.  <code>Nf</code> is upper triangular and nonsingular.</p><p>The full column rank pencil <code>Mil-λNil</code> is in a staircase form, and contains the  left Kronecker indices  and infinite elementary divisors of the subpencil <code>M22 - λN22</code>.  The <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mil-λNil</code> such that the <code>i</code>-th block has dimensions <code>ν[nb-i+1] x μ[nb-i+1]</code> and has full column rank.  The difference <code>ν[nb-i+1]-μ[nb-i+1]</code> for <code>i = 1, 2, ..., nb</code> is the number of elementary Kronecker blocks of size  <code>i x (i-1)</code>. The difference <code>μ[nb-i+1]-ν[nb-i]</code> for <code>i = 1, 2, ..., nb</code> is the number of infinite elementary  divisors of degree <code>i</code> (with <code>ν[0] = 0</code>).</p><p>The keyword arguments <code>atol</code> and <code>rtol</code>, specify the absolute and relative tolerances for the  nonzero elements of <code>M</code>, respectively. The internally employed absolute tolerance  for the  nonzero elements of <code>M</code> is returned in <code>tol</code>.  The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> (i.e., <code>Q &lt;- Q*Q1</code>)  if <code>withQ = true</code>. Otherwise, <code>Q</code> is not modified.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> (i.e., <code>Z &lt;- Z*Z1</code>)  if <code>withZ = true</code>. Otherwise, <code>Z</code> is not modified.   </p><p><code>Note:</code> If the subpencil <code>M22 - λN22</code> has full row rank, then the regular pencil <code>Mil-λNil</code> is in a staircase form with square upper triangular diagonal blocks (i.e.,<code>μ[i] = ν[i]</code>), and the difference <code>ν[nb-i+1]-ν[nb-i]</code> for  <code>i = 1, 2, ..., nb</code> is the number of infinite elementary divisors of degree <code>i</code> (with <code>ν[0] = 0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L649-L708">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_right_refine!" href="#MatrixPencils.klf_right_refine!"><code>MatrixPencils.klf_right_refine!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> klf_right_refine!(ν, μ, M, N, tol; fast = true, ut = false, roff = 0, coff = 0, rtrail = 0, ctrail = 0, withQ = true, withZ = true) -&gt; (νr, μr, νi)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">         [   *         *        *  ] roff
M - λN = [   0      Mri-λNri    *  ] mri
         [   0         0        *  ] rtrail
           coff      nri     ctrail</code></pre><p>to an equivalent form <code>F - λG = Q1&#39;*(M - λN)*Z1</code> using orthogonal or unitary transformation matrices <code>Q1</code> and <code>Z1</code>  such that the full row rank subpencil <code>Mri-λNri</code>is transformed into the  following Kronecker-like form  exhibiting its right and infinite Kronecker structures:</p><pre><code class="nohighlight hljs">              |  Mr-λNr    |     *      |
 Fri - λGri = |------------|------------|
              |    O       |   Mi-λNi   |</code></pre><p>The full row rank pencil <code>Mri-λNri</code> is in a staircase form and the <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code>  contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mri-λNri</code> such that  the <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code> and has full row rank. The matrix Mri has full row rank and  the trailing <code>μ[2]+...+μ[nb]</code> columns of <code>Nri</code> form a full column rank submatrix. </p><p>The full row rank pencil <code>Mr-λNr</code> is in a staircase form, contains the right Kronecker indices  of the pencil <code>M-λN</code>and has the form</p><pre><code class="nohighlight hljs">  Mr-λNr  = | Br | Ar-λEr |,</code></pre><p>where <code>Er</code> is upper triangular and nonsingular.  The <code>nr</code>-dimensional vectors <code>νr</code> and <code>μr</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mr-λNr</code> such that the <code>i</code>-th block has dimensions <code>νr[i] x μr[i]</code> and  has full row rank. The difference <code>μr[i]-νr[i] = μ[i]-ν[i]</code> for <code>i = 1, 2, ..., nr</code> is the number of  elementary Kronecker blocks of size <code>(i-1) x i</code>. If <code>ut = true</code>, the full row rank diagonal blocks of <code>Mr</code> are reduced to the form <code>[0 X]</code>  with <code>X</code> upper triangular and nonsingular and the full column rank supradiagonal blocks of <code>Nr</code> are reduced to the form <code>[Y; 0]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The regular pencil <code>Mi-λNi</code>is in a staircase form, contains the infinite elementary divisors of <code>Mri-λNri</code>,  <code>Mi</code> is upper triangular if <code>ut = true</code> and nonsingular and <code>Ni</code> is upper triangular and nilpotent. The <code>ni</code>-dimensional vector <code>νi</code> contains the dimensions of the  square diagonal blocks of the staircase form  <code>Mi-λNi</code> such that the <code>i</code>-th block has dimensions <code>νi[i] x νi[i]</code>.  The difference <code>νi[ni-i+1]-νi[ni-i] = ν[i]-μ[i+1]</code> for <code>i = 1, 2, ..., ni</code> is the number of infinite elementary  divisors of degree <code>i</code> (with <code>νi[0] = 0</code> and <code>μ[nb+1] = 0</code>).</p><p><code>F</code> and <code>G</code> are returned in <code>M</code> and <code>N</code>, respectively.  </p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> (i.e., <code>Q &lt;- Q*Q1</code>)  if <code>withQ = true</code>. Otherwise, <code>Q</code> is not modified.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> (i.e., <code>Z &lt;- Z*Z1</code>)  if <code>withZ = true</code>. Otherwise, <code>Z</code> is not modified.   </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L780-L830">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_right_refineut!" href="#MatrixPencils.klf_right_refineut!"><code>MatrixPencils.klf_right_refineut!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_right_refineut!(ν, μ, M, N, Q, Z; ctrail = 0, withQ = true, withZ = true)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">         [ Mri-λNri  *   ] 
M - λN = [    0      *   ] 
                   ctrail</code></pre><p>to an equivalent form <code>F - λG = Q1&#39;*(M - λN)*Z1</code> using orthogonal or unitary transformation  matrices  <code>Q1</code> and <code>Z1</code>, such that the full row rank subpencil <code>Mri-λNri</code>, in staircase form ,  is transformed as follows: the full row rank diagonal blocks of <code>Mri</code> are reduced to the form <code>[0 X]</code>  with <code>X</code> upper triangular and nonsingular and the full column rank supradiagonal blocks of <code>Nri</code> are reduced to the form <code>[Y; 0]</code> with <code>Y</code> upper triangular and nonsingular.  It is assumed that <code>Mri-λNri</code> has <code>nb</code> diagonal blocks and the dimensions of the diagonal blocks   are specified by the <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> such that the <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code>.  </p><p>The performed orthogonal or unitary transformations are accumulated in <code>Q</code> (i.e., <code>Q &lt;- Q*Q1</code>),  if <code>withQ = true</code> and <code>Z</code> (i.e., <code>Z &lt;- Z*Z1</code>), if <code>withZ = true</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L1187-L1206">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_right_refineinf!" href="#MatrixPencils.klf_right_refineinf!"><code>MatrixPencils.klf_right_refineinf!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_right_refineinf!(νi, M, N, Z, R; roff = 0, coff = 0, withZ = true)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">         [   *         *        *  ] roff
M - λN = [   0       Mi-λNi     *  ] ni
         [   0         0        *  ] rtrail
           coff       ni     ctrail</code></pre><p>to an equivalent form <code>F - λG = (M - λN)*Z1</code> using an orthogonal or unitary transformation  matrix <code>Z1</code>, such that the regular subpencil <code>Mi-λNi</code>, in staircase form ,  with <code>Mi</code> nonsingular and <code>Ni</code> nillpotent and upper triangular, is transformed to obtain  <code>Mi</code> is upper-triangular and preserve <code>Ni</code> upper triangular.  It is assumed that <code>Mi-λNi</code> has <code>nb</code> diagonal blocks and the <code>i</code>-th diagonal block has dimensions  <code>νi[i] x νi[i]</code>.</p><p>The performed orthogonal or unitary transformations are accumulated in <code>Z</code> (i.e., <code>Z &lt;- Z*Z1</code>),  if <code>withZ = true</code>. </p><p>The  matrix <code>R</code> is overwritten by <code>R*Z1</code> unless <code>R = missing</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L1342-L1363">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_left" href="#MatrixPencils.klf_left"><code>MatrixPencils.klf_left</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_left(M, N; fast = true, ut = false, atol1 = 0, atol2 = 0, rtol, withQ = true, withZ = true) -&gt; (F, G, Q, Z, ν, μ, nf, νl, μl)</code></pre><p>Reduce the matrix pencil <code>M - λN</code> to an equivalent form <code>F - λG = Q&#39;(M - λN)Z</code> using  orthogonal or unitary transformation matrices <code>Q</code> and <code>Z</code> such that the transformed matrices <code>F</code> and <code>G</code> are in the following Kronecker-like form exhibiting the finite and left Kronecker structures:</p><pre><code class="nohighlight hljs">               |  Mri-λNri  |     *      |    *    |
               |------------|------------|---------|
     F - λG =  |    O       |   Mf-λNf   |    *    |
               |------------|------------|---------|
               |    O       |     0      |  Ml-λNl |</code></pre><p>The full row rank pencil <code>Mri-λNri</code> is in a staircase form, and contains the right Kronecker indices  and infinite elementary divisors of the pencil <code>M-λN</code>.</p><p>The <code>nf x nf</code> pencil <code>Mf-λNf</code> is regular and contains the finite elementary divisors of <code>M-λN</code>.  <code>Nf</code> is upper triangular and nonsingular.</p><p>The full column rank pencil <code>Ml-λNl</code>, in a staircase form, contains the left Kronecker indices of <code>M-λN</code> and has the form</p><pre><code class="nohighlight hljs">               | Al-λEl |
     Ml-λNl  = |--------|,
               |   Cl   |</code></pre><p>where <code>El</code> is upper triangular and nonsingular. </p><p>The <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mri-λNri</code> such that <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code> and  has full row rank.  The difference <code>μ[i]-ν[i]</code> for <code>i = 1, 2, ..., nb</code> is the number of elementary Kronecker blocks of size <code>(i-1) x i</code>. The difference <code>ν[i]-μ[i+1]</code> for <code>i = 1, 2, ..., nb</code> is the number of infinite elementary divisors of degree <code>i</code>  (with <code>μ[nb+1] = 0</code>). If <code>ut = true</code>, the full row rank diagonal blocks of <code>Mri</code> are reduced to the form <code>[0 X]</code>  with <code>X</code> upper triangular and nonsingular and the full column rank supradiagonal blocks of <code>Nri</code> are reduced to the form <code>[Y; 0]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The <code>nl</code>-dimensional vectors <code>νl</code> and <code>μl</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Ml-λNl</code> such that the <code>j</code>-th block has dimensions <code>νl[j] x μl[j]</code> and has full column rank.  The difference <code>νl[nl-j+1]-μl[nl-j+1]</code> for <code>j = 1, 2, ..., nl</code> is the number of elementary Kronecker blocks of size  <code>j x (j-1)</code>. If <code>ut = true</code>, the full column rank diagonal blocks of <code>Ml</code> are reduced to the form <code>[X; 0]</code>  with <code>X</code> upper triangular and nonsingular and the full row rank supradiagonal blocks of <code>Nl</code> are reduced to the form <code>[0 Y]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The keyword arguments <code>atol1</code>, <code>atol2</code>, and <code>rtol</code>, specify, respectively, the absolute tolerance for the  nonzero elements of <code>M</code>, the absolute tolerance for the nonzero elements of <code>N</code>,  and the relative tolerance  for the nonzero elements of <code>M</code> and <code>N</code>.  The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> if <code>withQ = true</code>.  Otherwise, <code>Q</code> is set to <code>nothing</code>.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> if <code>withZ = true</code>.  Otherwise, <code>Z</code> is set to <code>nothing</code>.  </p><p><code>Note:</code> If the pencil <code>M - λN</code> has full column rank, then the regular pencil <code>Mri-λNri</code> is in a staircase form with square upper triangular diagonal blocks (i.e.,<code>μ[i] = ν[i]</code>), and the difference <code>ν[i+1]-ν[i]</code> for <code>i = 1, 2, ..., nb</code>  is the number of infinite elementary divisors of degree <code>i</code> (with <code>ν[nb+1] = 0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L432-L492">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_leftinf" href="#MatrixPencils.klf_leftinf"><code>MatrixPencils.klf_leftinf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_leftinf(M, N; fast = true, ut = false, atol1 = 0, atol2 = 0, rtol, withQ = true, withZ = true) 
            -&gt; (F, G, Q, Z, n, m, νi, νl, μl)</code></pre><p>Reduce the matrix pencil <code>M - λN</code> to an equivalent form <code>F - λG = Q&#39;(M - λN)Z</code> using  orthogonal or unitary transformation matrices <code>Q</code> and <code>Z</code> such that the transformed matrices <code>F</code> and <code>G</code> are in the following Kronecker-like form exhibiting the infinite and left Kronecker structures:</p><pre><code class="nohighlight hljs">               |  Mrf-λNrf  |     *      |    *    |
               |------------|------------|---------|
     F - λG =  |    O       |   Mi-λNi   |    *    |
               |------------|------------|---------|
               |    O       |     0      |  Ml-λNl |</code></pre><p>The full row rank pencil <code>Mrf-λNrf</code> contains the right Kronecker   and finite Kronecker structures of the pencil <code>M-λN</code> and is in the standard form </p><pre><code class="nohighlight hljs">      Mrf-λNrf = | B  | A-λE | ,</code></pre><p>where <code>E</code> is an <code>nxn</code> non-singular upper triangular matrix, and <code>A</code> and <code>B</code> are <code>nxn</code>- and <code>nxm</code>-dimensional matrices, respectively.                      </p><p>The regular pencil <code>Mi-λNi</code> is in a staircase form, contains the infinite elementary divisors of <code>M-λN</code>  with <code>Mi</code> upper triangular if <code>ut = true</code> and nonsingular, and <code>Ni</code> is upper triangular and nilpotent.  The <code>ni</code>-dimensional vector <code>νi</code> contains the dimensions of the  square diagonal blocks of the staircase form  <code>Mi-λNi</code> such that the <code>i</code>-th block has dimensions <code>νi[i] x νi[i]</code>.  The difference <code>νi[i]-νi[i-1] = ν[ni-i+1]-μ[ni-i+1]</code> for <code>i = 1, 2, ..., ni</code> is the number of infinite elementary  divisors of degree <code>i</code> (with <code>νi[0] = 0</code> and <code>μ[nb+1] = 0</code>).</p><p>The full column rank pencil <code>Ml-λNl</code>, in a staircase form, contains the left Kronecker indices of <code>M-λN</code> and has the form</p><pre><code class="nohighlight hljs">               | Al-λEl |
     Ml-λNl  = |--------|,
               |   Cl   |</code></pre><p>where <code>El</code> is upper triangular and nonsingular. </p><p>The <code>nl</code>-dimensional vectors <code>νl</code> and <code>μl</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Ml-λNl</code> such that the <code>j</code>-th block has dimensions <code>νl[j] x μl[j]</code> and has full column rank.  The difference <code>νl[nl-j+1]-μl[nl-j+1]</code> for <code>j = 1, 2, ..., nl</code> is the number of elementary Kronecker blocks of size  <code>j x (j-1)</code>. If <code>ut = true</code>, the full column rank diagonal blocks of <code>Ml</code> are reduced to the form <code>[X; 0]</code>  with <code>X</code> upper triangular and nonsingular and the full row rank supradiagonal blocks of <code>Nl</code> are reduced to the form <code>[0 Y]</code> with <code>Y</code> upper triangular and nonsingular. </p><p>The keyword arguments <code>atol1</code>, <code>atol2</code>, and <code>rtol</code>, specify, respectively, the absolute tolerance for the  nonzero elements of <code>M</code>, the absolute tolerance for the nonzero elements of <code>N</code>,  and the relative tolerance  for the nonzero elements of <code>M</code> and <code>N</code>.  The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> if <code>withQ = true</code>.  Otherwise, <code>Q</code> is set to <code>nothing</code>.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> if <code>withZ = true</code>.  Otherwise, <code>Z</code> is set to <code>nothing</code>.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L575-L631">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_left!" href="#MatrixPencils.klf_left!"><code>MatrixPencils.klf_left!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_left!(M, N; fast = true, roff = 0, coff = 0, rtrail = 0, ctrail = 0, atol = 0, rtol, withQ = true, withZ = true) -&gt; (Q, Z, ν, μ, nf, νl, μl, tol)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">          [   *         *        *  ] roff
 M - λN = [   0      M22-λN22    *  ] m
          [   0         0        *  ] rtrail
            coff        n     ctrail</code></pre><p>to an equivalent form <code>F - λG = Q1&#39;*(M - λN)*Z1</code> using orthogonal or unitary transformation matrices <code>Q1</code> and <code>Z1</code>  such that the subpencil <code>M22 - λN22</code>  is transformed into the following Kronecker-like form exhibiting  its finite and left Kronecker structures</p><pre><code class="nohighlight hljs">               |  Mri-λNri  |     *      |    *    |
               |------------|------------|---------|
 F22 - λG22 =  |    O       |   Mf-λNf   |    *    |
               |------------|------------|---------|
               |    O       |     0      |  Ml-λNl |</code></pre><p><code>F</code> and <code>G</code> are returned in <code>M</code> and <code>N</code>, respectively.                </p><p>The full row rank pencil <code>Mri-λNri</code> is in a staircase form, and contains the right Kronecker indices  and infinite elementary divisors of the subpencil <code>M22 - λN22</code>.  The <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mri-λNri</code> such that <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code> and  has full row rank.  The difference <code>μ[i]-ν[i]</code> for <code>i = 1, 2, ..., nb</code> is the number of elementary Kronecker blocks of size <code>(i-1) x i</code>. The difference <code>ν[i]-μ[i+1]</code> for <code>i = 1, 2, ..., nb</code> is the number of infinite elementary divisors of degree <code>i</code>  (with <code>μ[nb+1] = 0</code>).</p><p>The <code>nf x nf</code> pencil <code>Mf-λNf</code> is regular and contains the finite elementary divisors of <code>M-λN</code>.  <code>Nf</code> is upper triangular and nonsingular.</p><p>The full column rank pencil <code>Ml-λNl</code>, in a staircase form, contains the left Kronecker indices of <code>M-λN</code> and has the form</p><pre><code class="nohighlight hljs">               | Al-λEl |
     Ml-λNl  = |--------|,
               |   Cl   |</code></pre><p>where <code>El</code> is upper triangular and nonsingular.  The <code>nl</code>-dimensional vectors <code>νl</code> and <code>μl</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Ml-λNl</code> such that <code>j</code>-th block has dimensions <code>νl[nl-j+1] x μl[nl-j+1]</code> and has full column rank.  The difference <code>νl[nl-j+1]-μl[nl-j+1]</code> for <code>j = 1, 2, ..., nl</code> is the number of elementary Kronecker blocks of size  <code>j x (j-1)</code>.</p><p>The keyword arguments <code>atol</code> and <code>rtol</code>, specify the absolute and relative tolerances for the  nonzero elements of <code>M</code>, respectively. The internally employed absolute tolerance  for the  nonzero elements of <code>M</code> is returned in <code>tol</code>.  The reduction is performed using rank decisions based on rank revealing QR-decompositions with column pivoting  if <code>fast = true</code> or the more reliable SVD-decompositions if <code>fast = false</code>.</p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> (i.e., <code>Q &lt;- Q*Q1</code>)  if <code>withQ = true</code>. Otherwise, <code>Q</code> is not modified.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> (i.e., <code>Z &lt;- Z*Z1</code>)  if <code>withZ = true</code>. Otherwise, <code>Z</code> is not modified.   </p><p><code>Note:</code> If the pencil <code>M22 - λN22</code> has full column rank, then the regular pencil <code>Mri-λNri</code> is in a staircase form with square diagonal blocks (i.e.,<code>μ[i] = ν[i]</code>), and the difference <code>ν[i]-ν[i+1]</code> for <code>i = 1, 2, ..., nb</code>  is the number of infinite elementary divisors of degree <code>i</code> (with <code>ν[nb+1] = 0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L921-L981">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_left_refine!" href="#MatrixPencils.klf_left_refine!"><code>MatrixPencils.klf_left_refine!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_left_refine!(ν, μ, M, N, tol; fast = true, ut = false, roff = 0, coff = 0, rtrail = 0, ctrail = 0, withQ = true, withZ = true) -&gt; (νi, νl, μl)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">         [   *         *        *  ] roff
M - λN = [   0      Mil-λNil    *  ] mli
         [   0         0        *  ] rtrail
           coff      nli     ctrail</code></pre><p>to an equivalent form <code>F - λG = Q1&#39;*(M - λN)*Z1</code> using orthogonal or unitary transformation matrices <code>Q1</code> and <code>Z1</code>  such that the full column rank subpencil <code>Mil-λNil</code> is transformed into the  following Kronecker-like form  exhibiting its infinite and left Kronecker structures:</p><pre><code class="nohighlight hljs">              |  Mi-λNi    |     *      |
 Fil - λGil = |------------|------------|
              |    O       |   Ml-λNl   |</code></pre><p>The full column rank pencil <code>Mil-λNil</code> is in a staircase form and the <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code>  contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mil-λNil</code> such that  the <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code> and has full column rank. The matrix Mil has full column rank and  the leading <code>μ[1]+...+μ[nb-1]</code> columns of <code>Nil</code> form a full row rank submatrix. </p><p>The regular pencil <code>Mi-λNi</code> is in a staircase form, contains the infinite elementary divisors of <code>Mil-λNil</code>,   <code>Mi</code> is upper triangular if <code>ut = true</code> and nonsingular and <code>Ni</code> is upper triangular and nilpotent. The <code>nbi</code>-dimensional vector <code>νi</code> contains the dimensions of the  square diagonal blocks of the staircase form  <code>Mi-λNi</code> such that the <code>i</code>-th block has dimensions <code>νi[i] x νi[i]</code>.  The difference <code>νi[i]-νi[i-1] = ν[nbi-i+1]-μ[nbi-i+1]</code> for <code>i = 1, 2, ..., nbi</code> is the number of infinite elementary  divisors of degree <code>i</code> (with <code>νi[0] = 0</code> and <code>μ[nbi+1] = 0</code>).</p><p>The full column rank pencil <code>Mil-λNil</code> is in a staircase form, and contains the  left Kronecker indices  and infinite elementary divisors of the subpencil <code>M22 - λN22</code>.  The <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Mil-λNil</code> such that the <code>i</code>-th block has dimensions <code>ν[nb-i+1] x μ[nb-i+1]</code> and has full column rank.  The difference <code>ν[nb-i+1]-μ[nb-i+1]</code> for <code>i = 1, 2, ..., nb</code> is the number of elementary Kronecker blocks of size  <code>i x (i-1)</code>. The difference <code>μ[nb-i+1]-ν[nb-i]</code> for <code>i = 1, 2, ..., nb</code> is the number of infinite elementary  divisors of degree <code>i</code> (with <code>ν[0] = 0</code>).</p><p>The full column rank pencil <code>Ml-λNl</code>, in a staircase form, contains the left Kronecker indices of <code>M-λN</code> and has the form</p><pre><code class="nohighlight hljs">           | Al-λEl |
 Ml-λNl  = |--------|,
           |   Cl   |</code></pre><p>where <code>El</code> is upper triangular and nonsingular.  The <code>nl</code>-dimensional vectors <code>νl</code> and <code>μl</code> contain the row and, respectively, column dimensions of the blocks of the staircase form  <code>Ml-λNl</code> such that the <code>j</code>-th block has dimensions <code>νl[j] x μl[j]</code> and has full column rank.  The difference <code>νl[nl-j+1]-μl[nl-j+1] = ν[nl-j+1]-μ[nl-j+1]</code> for <code>j = 1, 2, ..., nl</code> is the number of elementary  Kronecker blocks of size <code>j x (j-1)</code>. If <code>ut = true</code>, the full column rank diagonal blocks of <code>Ml</code> are reduced to the form <code>[Y; 0]</code>  with <code>Y</code> upper triangular and nonsingular and the full row rank supradiagonal blocks of <code>Nl</code> are reduced to the form <code>[0 Y]</code> with <code>Y</code> upper triangular and nonsingular. </p><p><code>F</code> and <code>G</code> are returned in <code>M</code> and <code>N</code>, respectively.  </p><p>The performed left orthogonal or unitary transformations are accumulated in the matrix <code>Q</code> (i.e., <code>Q &lt;- Q*Q1</code>)  if <code>withQ = true</code>. Otherwise, <code>Q</code> is not modified.    The performed right orthogonal or unitary transformations are accumulated in the matrix <code>Z</code> (i.e., <code>Z &lt;- Z*Z1</code>)  if <code>withZ = true</code>. Otherwise, <code>Z</code> is not modified.   </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L1048-L1106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_left_refineut!" href="#MatrixPencils.klf_left_refineut!"><code>MatrixPencils.klf_left_refineut!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_left_refineut!(ν, μ, M, N, Q, Z; roff = 0, coff = 0, withQ = true, withZ = true)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">         [  *     *     ] roff
M - λN = [  0  Mil-λNil ] 
          coff</code></pre><p>to an equivalent form <code>F - λG = Q1&#39;*(M - λN)*Z1</code> using orthogonal or unitary transformation  matrices  <code>Q1</code> and <code>Z1</code>, such that the full column rank subpencil <code>Mil-λNil</code>, in staircase form ,  is transformed as follows: the full column rank diagonal blocks of <code>Mil</code> are reduced to the form <code>[Y ; 0]</code>  with <code>Y</code> upper triangular and nonsingular and the full row rank supradiagonal blocks of <code>Nil</code> are reduced to the form <code>[0 Y]</code> with <code>Y</code> upper triangular and nonsingular.  It is assumed that <code>Mil-λNil</code> has <code>nb</code> diagonal blocks and the dimensions of the diagonal blocks   are specified by the <code>nb</code>-dimensional vectors <code>ν</code> and <code>μ</code> such that the <code>i</code>-th block has dimensions <code>ν[i] x μ[i]</code>.  </p><p>The performed orthogonal or unitary transformations are accumulated in <code>Q</code> (i.e., <code>Q &lt;- Q*Q1</code>),  if <code>withQ = true</code> and <code>Z</code> (i.e., <code>Z &lt;- Z*Z1</code>), if <code>withZ = true</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L1264-L1283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixPencils.klf_left_refineinf!" href="#MatrixPencils.klf_left_refineinf!"><code>MatrixPencils.klf_left_refineinf!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klf_left_refineinf!(νi, M, N, Q, L; roff = 0, coff = 0, withQ = true)</code></pre><p>Reduce the partitioned matrix pencil <code>M - λN</code> (<code>*</code> stands for a not relevant subpencil)</p><pre><code class="nohighlight hljs">         [   *         *        *  ] roff
M - λN = [   0       Mi-λNi     *  ] ni
         [   0         0        *  ] rtrail
           coff       ni     ctrail</code></pre><p>to an equivalent form <code>F - λG = Q1&#39;*(M - λN)</code> using an orthogonal or unitary transformation  matrix <code>Q1</code>, such that the regular subpencil <code>Mi-λNi</code>, in staircase form,  with <code>Mi</code> nonsingular and <code>Ni</code> nillpotent and upper triangular, is transformed to obtain  <code>Mi</code> upper-triangular and preserve <code>Ni</code> upper triangular.  It is assumed that <code>Mi-λNi</code> has <code>nb</code> diagonal blocks and the <code>i</code>-th diagonal block has dimensions  <code>νi[i] x νi[i]</code>.</p><p>The performed orthogonal or unitary transformations are accumulated in <code>Q</code> (i.e., <code>Q &lt;- Q*Q1</code>),  if <code>withQ = true</code>. </p><p>The  matrix <code>L</code> is overwritten by <code>Q1&#39;*L</code> unless <code>L = missing</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/andreasvarga/MatrixPencils.jl/blob/c5c9bfbff586cfcacdfcc20b4a39d7d4deb23bb9/src/klftools.jl#L1394-L1415">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Home</a><a class="docs-footer-nextpage" href="sklftools.html">Manipulation of structured linear matrix pencils »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Tuesday 24 June 2025 14:55">Tuesday 24 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
